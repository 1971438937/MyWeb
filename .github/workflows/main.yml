name: Deploy Blog 
on:
        push:
                branches:
                        - Blog

jobs:
        build-and-deploy:
                runs-on: ubuntu-latest
                steps:
                        - name: git checkout

                          uses: actions/checkout@v1

                        - name: setup nodejs

                          uses: actions/setup-node@v1

                        - name: install hexo

                          run: |
                                  npm install hexo-cli -g
                                  npm i -S hexo-prism-plugin -g
                                  npm install hexo-generator-search --save -g
                                  npm i hexo-permalink-pinyin  -g
                                  npm i --save hexo-wordcount -g
                                  npm install hexo-filter-github-emojis  -g
                                  npm install hexo-generator-feed  -g
                                  npm install

                        - name: hexo generate public

                          run: |
                                  hexo clean
                                  hexo g
                      
                       - name: Deploy
        uses: easingthemes/ssh-deploy@v2.2.11 # 使用 NodeJS 通过 ssh 部署 rsync 代码
        env:
         SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
         ARGS: "-rltgoDzvO"
         SOURCE: ${{ secrets.SOURCE }}
         REMOTE_HOST: ${{ secrets.REMOTE_HOST }}
         REMOTE_USER: ${{ secrets.REMOTE_USER }}
         REMOTE_PORT: ${{ secrets.REMOTE_PORT }}
         TARGET: ${{ secrets.TARGET }}
